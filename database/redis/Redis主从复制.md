# Redis主从复制

redis支持通过slaveof指令，将当前服务器变成目标服务器的从服务器。从服务器会跟目标服务器数据保持同步。

## 主从复制流程
1. 从库向主库发送sync命令。
2. 主库接受到psync命令后，psync会告诉主库自己已同步的数据偏移量，主库只需要根据偏移量选择需要的数据进行发送，首次复制时偏移量是-1，如果偏移量在缓存区中，则会直接发送缓冲区中的数据，并不会执行持久化。
3. 持久化完毕后，主库将rdb文件发送给从库，从库接受文件后加载数据。
4. 主库将缓冲区中的指令发送给从库
5. 后续每当主库接收到写命令，就会把请求发送给从库，从库接收并处理请求。

